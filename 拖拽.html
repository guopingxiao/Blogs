<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>拖拽继承</title>
    <style type="text/css">
        #div1{width: 100px;height: 100px;background: black;position: absolute;z-index: 2;}
        #div2{width: 40%;height: 500px;background: red;position: relative;float: left}
        #div3{width: 60%;height: 500px;background: blue;margin-left: 40%;}
    </style>
</head>

<body>
<div id="div1"></div>
<div id="div2"></div>
<div id="div3"></div>


<script type="text/javascript">

window.onload = function(){
    /*var d1 = new Drag('div1');
    d1.init();*/

    var d2 = new childDrag('div1');
    d2.init();
}


function Drag(id){
    this.obj = document.getElementById(id);//定义拖拽的对象
    this.disX = 0;//水平边距
    this.disY = 0;//垂直边距
}

Drag.prototype.init = function(){//拖拽函数
    var that = this;
    this.obj.onmousedown = function(e){
        var e = e || window.event;
        that.fnDown(e);

        document.onmousemove = function(e){
            var e = e || window.evnet;
            that.fnMove(e);
        }
        document.onmouseup = function(){
            that.fnUP();
        }
        return false;
    }

}

Drag.prototype.fnDown = function(e){
    //clientX 返回当事件被触发时，鼠标指针的水平坐标
    //offsetLeft:获取对象相对于版面左侧位置
    this.disX = e.clientX - this.obj.offsetLeft;//鼠标位置到obj左边位置
    this.disY = e.clientY - this.obj.offsetTop;
}

Drag.prototype.fnMove = function(e){
    this.obj.style.left = e.clientX - this.disX + 'px';
    this.obj.style.top = e.clientY - this.disY +'px';
}

Drag.prototype.fnUP = function(e){
    document.onmousedown= null;
    document.onmousemove = null;
    this.judePoston(e)
}

childDrag.prototype.judePoston = function(e){
    var leftX = e.clientX - this.disX;
    var clientW = document.documentElement.clientWidth - this.obj.offsetWidth;
}
//定义子类，子类继承父类，但是与父类有不同，不能拖拽脱离可视区域

function childDrag(id){
    Drag.call(this,id);//属性用call，apply
}

// 方法用for in 
extend(childDrag.prototype,Drag.prototype);

//重写父类的方法
childDrag.prototype.fnMove = function(e){
    var leftX = e.clientX - this.disX;
    var topY = e.clientY - this.disY;
    var clientW = document.documentElement.clientWidth - this.obj.offsetWidth;
    var clientH = document.documentElement.clientHeight  - this.obj.offsetHeight;

    if (leftX < 0){
        leftX = 0;
    }else if (leftX >clientW) {
        leftX = clientW;
    }

    if (topY < 0 ) {
        topY = 0;
    }else if (topY> clientH) {
        topY = clientH;
    }

    this.obj.style.left = leftX + 'px';
    this.obj.style.top = topY + 'px';
}


function extend(obj1, obj2){//拷贝函数
    for(var attr in obj2){
        obj1[attr] = obj2[attr];
    }
}

</script>
</body>
</html>